version: '2'
services:
  parity:
    image: "ethcore/parity:${ES_PARITY_VERSION}"
    ports:
     - "30303:30303"
     - "8545:8545"
    volumes:
     - "${ES_PARITY_SHARED_FOLDER}:${ES_PARITY_SHARED_FOLDER}"
    command: "--base-path ${ES_PARITY_SHARED_FOLDER} --config ${ES_PARITY_SHARED_FOLDER}/config.toml"
    restart: always
    environment:
     - VIRTUAL_HOST=testnet.etherstellar.io
     - VIRTUAL_NETWORK=nginx-proxy
     - VIRTUAL_PORT=8545
     - LETSENCRYPT_HOST=testnet.etherstellar.io
     - LETSENCRYPT_EMAIL=admin@etherstellar.io
  
  nginxproxy:
    image: jwilder/nginx-proxy
    volumes:
     - /path/to/certs:/etc/nginx/certs:ro
     - /etc/nginx/vhost.d
     - /usr/share/nginx/html
     - /var/run/docker.sock:/tmp/docker.sock:ro
    ports:
     - "80:80"
     - "443:443"
    labels:
     - com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy=true

  letsencrypt:
    image: alastaircoote/docker-letsencrypt-nginx-proxy-companion
    volumes:
     - /path/to/certs:/etc/nginx/certs:rw
     - /var/run/docker.sock:/var/run/docker.sock:ro
    volumes_from:
     - nginxproxy